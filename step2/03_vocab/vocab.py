import time
import pickle
MALWARE_GRAMS_FILE_NAME = "../02_n_gram/the_entire_ngram_Malware_about_3_grams.pickle"
NORMAL_GRAMS_FILE_NAME = "../02_n_gram/the_entire_ngram_Normal_about_3_grams.pickle"
VOCAB_FILE_NAME = "vocab.pickle"
STOP_POINT = 10

def addGramToVocab(path, vocab, idx):
    global STOP_POINT
    with open(path, 'rb') as f :
        grams = pickle.load(f)
        count = 0
        for gram in grams :
            if gram in vocab :
                continue
            count += 1
            vocab[gram] = str(idx)
            idx += 1
            # if count == STOP_POINT :
            #     break
    return idx

def makeVocab():
    global MALWARE_GRAMS_FILE_NAME, NORMAL_GRAMS_FILE_NAME, VOCAB_FILE_NAME
    vocab = {}
    idx = 1 # 나중에 패딩 0으로
    idx = addGramToVocab(MALWARE_GRAMS_FILE_NAME, vocab, idx)
    idx = addGramToVocab(NORMAL_GRAMS_FILE_NAME, vocab, idx)

    with open(VOCAB_FILE_NAME , 'wb') as f :
        pickle.dump(vocab, f)

def loadVocab():
    global VOCAB_FILE_NAME
    with open(VOCAB_FILE_NAME, 'rb') as f :
        vocab = pickle.load(f)
    return vocab

start_time = time.time()
makeVocab()
print(loadVocab())
with open('execution_time.txt', 'a') as f:
    f.write("Execution time :" + str(time.time()-start_time) + "\n")